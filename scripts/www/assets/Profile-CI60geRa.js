import{d as z,t as L,a as r,T as V,H,I as j,f as x,c as C,w as T,n as b,g as U,h as q,i as J,j as K,k as A,l as $,r as k,p as M,q as B,s as I,v as G,x as Q,m as E,F as W,y as F,z as X,o as Y,b as Z,e as N,A as p,D as ee,E as ne}from"./index-CAWPox-O.js";import{N as re}from"./index-DGZfK3hW.js";import{s as te}from"./function-call-CHm7p81i.js";const[ae,D]=C("tag"),oe={size:String,mark:Boolean,show:L,type:x("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var ie=z({name:ae,props:oe,emits:["close"],setup(e,{slots:n,emit:s}){const u=i=>{i.stopPropagation(),s("close",i)},l=()=>e.plain?{color:e.textColor||e.color,borderColor:e.color}:{color:e.textColor,background:e.color},a=()=>{var i;const{type:f,mark:m,plain:o,round:d,size:g,closeable:y}=e,v={mark:m,plain:o,round:d};g&&(v[g]=g);const h=y&&r(j,{name:"cross",class:[D("close"),H],onClick:u},null);return r("span",{style:l(),class:D([v,f])},[(i=n.default)==null?void 0:i.call(n),h])};return()=>r(V,{name:e.closeable?"van-fade":void 0},{default:()=>[e.show?a():null]})}});const ce=T(ie),[le,S]=C("image"),se={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:b,height:b,radius:b,lazyLoad:Boolean,iconSize:b,showError:L,errorIcon:x("photo-fail"),iconPrefix:String,showLoading:L,loadingIcon:x("photo"),crossorigin:String,referrerpolicy:String,decoding:String};var ue=z({name:le,props:se,emits:["load","error"],setup(e,{emit:n,slots:s}){const u=k(!1),l=k(!0),a=k(),{$Lazyload:i}=U().proxy,f=M(()=>{const t={width:B(e.width),height:B(e.height)};return I(e.radius)&&(t.overflow="hidden",t.borderRadius=B(e.radius)),t});q(()=>e.src,()=>{u.value=!1,l.value=!0});const m=t=>{l.value&&(l.value=!1,n("load",t))},o=()=>{const t=new Event("load");Object.defineProperty(t,"target",{value:a.value,enumerable:!0}),m(t)},d=t=>{u.value=!0,l.value=!1,n("error",t)},g=(t,_,P)=>P?P():r(j,{name:t,size:e.iconSize,class:_,classPrefix:e.iconPrefix},null),y=()=>{if(l.value&&e.showLoading)return r("div",{class:S("loading")},[g(e.loadingIcon,S("loading-icon"),s.loading)]);if(u.value&&e.showError)return r("div",{class:S("error")},[g(e.errorIcon,S("error-icon"),s.error)])},v=()=>{if(u.value||!e.src)return;const t={alt:e.alt,class:S("img"),decoding:e.decoding,style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?G(r("img",E({ref:a},t),null),[[Q("lazy"),e.src]]):r("img",E({ref:a,src:e.src,onLoad:m,onError:d},t),null)},h=({el:t})=>{const _=()=>{t===a.value&&l.value&&o()};a.value?_():$(_)},w=({el:t})=>{t===a.value&&!u.value&&d()};return i&&J&&(i.$on("loaded",h),i.$on("error",w),K(()=>{i.$off("loaded",h),i.$off("error",w)})),A(()=>{$(()=>{var t;(t=a.value)!=null&&t.complete&&!e.lazyLoad&&o()})}),()=>{var t;return r("div",{class:S({round:e.round,block:e.block}),style:f.value},[v(),y(),(t=s.default)==null?void 0:t.call(s)])}}});const de=T(ue),[ge,c]=C("card"),me={tag:String,num:b,desc:String,thumb:String,title:String,price:b,centered:Boolean,lazyLoad:Boolean,currency:x("¥"),thumbLink:String,originPrice:b};var fe=z({name:ge,props:me,emits:["clickThumb"],setup(e,{slots:n,emit:s}){const u=()=>{if(n.title)return n.title();if(e.title)return r("div",{class:[c("title"),"van-multi-ellipsis--l2"]},[e.title])},l=()=>{if(n.tag||e.tag)return r("div",{class:c("tag")},[n.tag?n.tag():r(ce,{mark:!0,type:"primary"},{default:()=>[e.tag]})])},a=()=>n.thumb?n.thumb():r(de,{src:e.thumb,fit:"cover",width:"100%",height:"100%",lazyLoad:e.lazyLoad},null),i=()=>{if(n.thumb||e.thumb)return r("a",{href:e.thumbLink,class:c("thumb"),onClick:o=>s("clickThumb",o)},[a(),l()])},f=()=>{if(n.desc)return n.desc();if(e.desc)return r("div",{class:[c("desc"),"van-ellipsis"]},[e.desc])},m=()=>{const o=e.price.toString().split(".");return r("div",null,[r("span",{class:c("price-currency")},[e.currency]),r("span",{class:c("price-integer")},[o[0]]),o.length>1&&r(W,null,[F("."),r("span",{class:c("price-decimal")},[o[1]])])])};return()=>{var o,d,g;const y=n.num||I(e.num),v=n.price||I(e.price),h=n["origin-price"]||I(e.originPrice),w=y||v||h||n.bottom,t=v&&r("div",{class:c("price")},[n.price?n.price():m()]),_=h&&r("div",{class:c("origin-price")},[n["origin-price"]?n["origin-price"]():`${e.currency} ${e.originPrice}`]),P=y&&r("div",{class:c("num")},[n.num?n.num():`x${e.num}`]),O=n.footer&&r("div",{class:c("footer")},[n.footer()]),R=w&&r("div",{class:c("bottom")},[(o=n["price-top"])==null?void 0:o.call(n),t,_,P,(d=n.bottom)==null?void 0:d.call(n)]);return r("div",{class:c()},[r("div",{class:c("header")},[i(),r("div",{class:c("content",{centered:e.centered})},[r("div",null,[u(),f(),(g=n.tags)==null?void 0:g.call(n)]),R])]),O])}}});const ve=T(fe),he={style:{padding:"16px","padding-bottom":"60px"}},Se={__name:"Profile",setup(e){const n=X(),s=k(null);A(()=>{const l=localStorage.getItem("userInfo");l&&(s.value=JSON.parse(l))});const u=()=>{te({title:"提示",message:"确定退出登录吗？"}).then(()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),ne("已退出登录"),n.replace("/login")})};return(l,a)=>{var o,d;const i=re,f=ve,m=ee;return Y(),Z("div",he,[r(i,{title:"我的"}),r(f,{desc:(o=s.value)==null?void 0:o.username,title:((d=s.value)==null?void 0:d.nickname)||"未登录",style:{margin:"16px 0"}},{thumb:N(()=>[...a[0]||(a[0]=[p("img",{src:"https://fastly.jsdelivr.net/npm/@vant/assets/user-active.png",width:"60",height:"60"},null,-1)])]),_:1},8,["desc","title"]),r(m,{block:"",type:"danger",onClick:u},{default:N(()=>[...a[1]||(a[1]=[F("退出登录",-1)])]),_:1})])}}};export{Se as default};
